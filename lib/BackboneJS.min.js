//
//  BackboneJS
//
//  Version: v2.0.0
//
//  Copyright (c)2017 Aaron Nathaniel Gray.
//  Copyright (c) 2010-2017 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//  Copyright (c) 2017 Derick Bailey, Muted Solutions, LLC.
//  Distributed under MIT license
//
//  https://backbonejs.com
//
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("underscore"),require("jQuery")):"function"==typeof define&&define.amd?define(["underscore","jQuery"],e):t.Backbone=t.Backbone=e(t._,t.$)}(this,function(t,e){"use strict";function i(){return e.ajax.apply(e,arguments)}t="default"in t?t.default:t,e="default"in e?e.default:e;var n,s="2.0.0",r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o={},a=/\s+/,h=function e(i,n,s,o,h){var u,c=0;if(s&&"object"===("undefined"==typeof s?"undefined":r(s))){void 0!==o&&"context"in h&&void 0===h.context&&(h.context=o);for(u=t.keys(s);c<u.length;c++)n=e(i,n,u[c],s[u[c]],h)}else if(s&&a.test(s))for(u=s.split(a);c<u.length;c++)n=i(n,u[c],o,h);else n=i(n,s,o,h);return n};o.on=function(t,e,i){if(this._events=h(u,this._events||{},t,e,{context:i,ctx:this,listening:n}),n){var s=this._listeners||(this._listeners={});s[n.id]=n,n.interop=!1}return this},o.listenTo=function(e,i,s){if(!e)return this;var r=e._listenId||(e._listenId=t.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=n=o[r];a||(this._listenId||(this._listenId=t.uniqueId("l")),a=n=o[r]=new v(this,e));var h=c(e,i,s,this);if(n=void 0,h)throw h;return a.interop&&a.on(i,s),this};var u=function(t,e,i,n){if(i){var s=t[e]||(t[e]=[]),r=n.context,o=n.ctx,a=n.listening;a&&a.count++,s.push({callback:i,context:r,ctx:r||o,listening:a})}return t},c=function(t,e,i,n){try{t.on(e,i,n)}catch(t){return t}};o.off=function(t,e,i){return this._events?(this._events=h(l,this._events,t,e,{context:i,listeners:this._listeners}),this):this},o.stopListening=function(e,i,n){var s=this._listeningTo;if(!s)return this;for(var r=e?[e._listenId]:t.keys(s),o=0;o<r.length;o++){var a=s[r[o]];if(!a)break;a.obj.off(i,n,this),a.interop&&a.off(i,n)}return t.isEmpty(s)&&(this._listeningTo=void 0),this};var l=function(e,i,n,s){if(e){var r,o=s.context,a=s.listeners,h=0;if(i||o||n){for(r=i?[i]:t.keys(e);h<r.length;h++){i=r[h];var u=e[i];if(!u)break;for(var c=[],l=0;l<u.length;l++){var d=u[l];if(n&&n!==d.callback&&n!==d.callback._callback||o&&o!==d.context)c.push(d);else{var f=d.listening;f&&f.off(i,n)}}c.length?e[i]=c:delete e[i]}return e}for(r=t.keys(a);h<r.length;h++)a[r[h]].cleanup()}};o.once=function(e,i,n){var s=h(d,{},e,i,t.bind(this.off,this));return"string"==typeof e&&null==n&&(i=void 0),this.on(s,i,n)},o.listenToOnce=function(e,i,n){var s=h(d,{},i,n,t.bind(this.stopListening,this,e));return this.listenTo(e,s)};var d=function(e,i,n,s){if(n){var r=e[i]=t.once(function(){s(i,r),n.apply(this,arguments)});r._callback=n}return e};o.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return h(f,this._events,t,void 0,i),this};var f=function(t,e,i,n){if(t){var s=t[e],r=t.all;s&&r&&(r=r.slice()),s&&p(s,n),r&&p(r,[e].concat(n))}return t},p=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}},v=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};v.prototype.on=o.on,v.prototype.off=function(t,e){var i;this.interop?(this._events=h(l,this._events,t,e,{context:void 0,listeners:void 0}),i=!this._events):(this.count--,i=0===this.count),i&&this.cleanup()},v.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},o.bind=o.on,o.unbind=o.off;var g=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}},m=function(){throw new Error('A "url" property or function must be specified')},y=function(e,i){var n,s=this;return n=e&&t.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},t.extend(n,s,i),n.prototype=t.create(s.prototype,e),n.prototype.constructor=n,n.__super__=s.prototype,n},_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(e,i){var n=e||{};i||(i={}),this.preinitialize.apply(this,arguments),this.cid=t.uniqueId(this.cidPrefix),this.attributes={},i.collection&&(this.collection=i.collection),i.parse&&(n=this.parse(n,i)||{});var s=t.result(this,"defaults");n=t.defaults(t.extend({},s,n),s),this.set(n,i),this.changed={},this.initialize.apply(this,arguments)};t.extend(b.prototype,o,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return t.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(e){return t.escape(this.get(e))},has:function(t){return null!=this.get(t)},matches:function(e){return!!t.iteratee(e,this)(this.attributes)},set:function(e,i,n){if(null==e)return this;var s;if("object"===("undefined"==typeof e?"undefined":_(e))?(s=e,n=i):(s={})[e]=i,n||(n={}),!this._validate(s,n))return!1;var r=n.unset,o=n.silent,a=[],h=this._changing;this._changing=!0,h||(this._previousAttributes=t.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,l=this._previousAttributes;for(var d in s)i=s[d],t.isEqual(u[d],i)||a.push(d),t.isEqual(l[d],i)?delete c[d]:c[d]=i,r?delete u[d]:u[d]=i;if(this.idAttribute in s&&(this.id=this.get(this.idAttribute)),!o){a.length&&(this._pending=n);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,u[a[f]],n)}if(h)return this;if(!o)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,i){return this.set(e,void 0,t.extend({},i,{unset:!0}))},clear:function(e){var i={};for(var n in this.attributes)i[n]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):t.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&t.clone(this.changed);var i,n=this._changing?this._previousAttributes:this.attributes,s={};for(var r in e){var o=e[r];t.isEqual(n[r],o)||(s[r]=o,i=!0)}return!!i&&s},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return t.clone(this._previousAttributes)},fetch:function(e){e=t.extend({parse:!0},e);var i=this,n=e.success;return e.success=function(t){var s=e.parse?i.parse(t,e):t;return!!i.set(s,e)&&(n&&n.call(e.context,i,t,e),void i.trigger("sync",i,t,e))},g(this,e),this.sync("read",this,e)},save:function(e,i,n){var s;null==e||"object"===("undefined"==typeof e?"undefined":_(e))?(s=e,n=i):(s={})[e]=i,n=t.extend({validate:!0,parse:!0},n);var r=n.wait;if(s&&!r){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;var o=this,a=n.success,h=this.attributes;n.success=function(e){o.attributes=h;var i=n.parse?o.parse(e,n):e;return r&&(i=t.extend({},s,i)),!(i&&!o.set(i,n))&&(a&&a.call(n.context,o,e,n),void o.trigger("sync",o,e,n))},g(this,n),s&&r&&(this.attributes=t.extend({},h,s));var u=this.isNew()?"create":n.patch?"patch":"update";"patch"!==u||n.attrs||(n.attrs=s);var c=this.sync(u,this,n);return this.attributes=h,c},destroy:function e(i){i=i?t.clone(i):{};var n=this,s=i.success,r=i.wait,e=function(){n.stopListening(),n.trigger("destroy",n,n.collection,i)};i.success=function(t){r&&e(),s&&s.call(i.context,n,t,i),n.isNew()||n.trigger("sync",n,t,i)};var o=!1;return this.isNew()?t.defer(i.success):(g(this,i),o=this.sync("delete",this,i)),r||e(),o},url:function(){var e=t.result(this,"urlRoot")||t.result(this.collection,"url")||m();if(this.isNew())return e;var i=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(i)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},t.extend({},e,{validate:!0}))},_validate:function(e,i){if(!i.validate||!this.validate)return!0;e=t.extend({},this.attributes,e);var n=this.validationError=this.validate(e,i)||null;return!n||(this.trigger("invalid",this,n,t.extend(i,{validationError:n})),!1)}}),b.extend=y;var x=function(e,i){i||(i={}),this.preinitialize.apply(this,arguments),i.model&&(this.model=i.model),void 0!==i.comparator&&(this.comparator=i.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,t.extend({silent:!0},i))},w={add:!0,remove:!0,merge:!0},E={add:!0,remove:!1},k=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,s=Array(t.length-i),r=e.length;for(n=0;n<s.length;n++)s[n]=t[n+i];for(n=0;n<r;n++)t[n+i]=e[n];for(n=0;n<s.length;n++)t[n+r+i]=s[n]};t.extend(x.prototype,o,{model:b,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(e,i){return this.set(e,t.extend({merge:!1},i,E))},remove:function(e,i){i=t.extend({},i);var n=!t.isArray(e);e=n?[e]:e.slice();var s=this._removeModels(e,i);return!i.silent&&s.length&&(i.changes={added:[],merged:[],removed:s},this.trigger("update",this,i)),n?s[0]:s},set:function e(i,n){if(null!=i){n=t.extend({},w,n),n.parse&&!this._isModel(i)&&(i=this.parse(i,n)||[]);var s=!t.isArray(i);i=s?[i]:i.slice();var r=n.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,a,e=[],h=[],u=[],c=[],l={},d=n.add,f=n.merge,p=n.remove,v=!1,g=this.comparator&&null==r&&n.sort!==!1,m=t.isString(this.comparator)?this.comparator:null;for(a=0;a<i.length;a++){o=i[a];var y=this.get(o);if(y){if(f&&o!==y){var _=this._isModel(o)?o.attributes:o;n.parse&&(_=y.parse(_,n)),y.set(_,n),u.push(y),g&&!v&&(v=y.hasChanged(m))}l[y.cid]||(l[y.cid]=!0,e.push(y)),i[a]=y}else d&&(o=i[a]=this._prepareModel(o,n),o&&(h.push(o),this._addReference(o,n),l[o.cid]=!0,e.push(o)))}if(p){for(a=0;a<this.length;a++)o=this.models[a],l[o.cid]||c.push(o);c.length&&this._removeModels(c,n)}var b=!1,x=!g&&d&&p;if(e.length&&x?(b=this.length!==e.length||t.some(this.models,function(t,i){return t!==e[i]}),this.models.length=0,k(this.models,e,0),this.length=this.models.length):h.length&&(g&&(v=!0),k(this.models,h,null==r?this.length:r),this.length=this.models.length),v&&this.sort({silent:!0}),!n.silent){for(a=0;a<h.length;a++)null!=r&&(n.index=r+a),o=h[a],o.trigger("add",o,this,n);(v||b)&&this.trigger("sort",this,n),(h.length||c.length||u.length)&&(n.changes={added:h,removed:c,merged:u},this.trigger("update",this,n))}return s?i[0]:i}},reset:function(e,i){i=i?t.clone(i):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],i);return i.previousModels=this.models,this._reset(),e=this.add(e,t.extend({silent:!0},i)),i.silent||this.trigger("reset",this,i),e},push:function(e,i){return this.add(e,t.extend({at:this.length},i))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(e,i){return this.add(e,t.extend({at:0},i))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(e){var i=this.comparator;if(!i)throw new Error("Cannot sort a set without a comparator");e||(e={});var n=i.length;return t.isFunction(i)&&(i=t.bind(i,this)),1===n||t.isString(i)?this.models=this.sortBy(i):this.models.sort(i),e.silent||this.trigger("sort",this,e),this},pluck:function(t){return this.map(t+"")},fetch:function(e){e=t.extend({parse:!0},e);var i=e.success,n=this;return e.success=function(t){var s=e.reset?"reset":"set";n[s](t,e),i&&i.call(e.context,n,t,e),n.trigger("sync",n,t,e)},g(this,e),this.sync("read",this,e)},create:function(e,i){i=i?t.clone(i):{};var n=i.wait;if(e=this._prepareModel(e,i),!e)return!1;n||this.add(e,i);var s=this,r=i.success;return i.success=function(t,e,i){n&&s.add(t,i),r&&r.call(i.context,t,e,i)},e.save(null,i),e},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new I(this,T)},keys:function(){return new I(this,A)},entries:function(){return new I(this,P)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,i){if(this._isModel(e))return e.collection||(e.collection=this),e;i=i?t.clone(i):{},i.collection=this;var n=new this.model(e,i);return n.validationError?(this.trigger("invalid",this,n.validationError,i),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var s=this.get(t[n]);if(s){var r=this.indexOf(s);this.models.splice(r,1),this.length--,delete this._byId[s.cid];var o=this.modelId(s.attributes);null!=o&&delete this._byId[o],e.silent||(e.index=r,s.trigger("remove",s,this,e)),i.push(s),this._removeReference(s,e)}}return i},_isModel:function(t){return t instanceof b},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var s=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);s!==r&&(null!=s&&delete this._byId[s],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}});var S="function"==typeof Symbol&&Symbol.iterator;S&&(x.prototype[S]=x.prototype.values);var I=function(t,e){this._collection=t,this._kind=e,this._index=0},T=1,A=2,P=3;S&&(I.prototype[S]=function(){return this}),I.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t=this._collection.at(this._index);this._index++;var e;if(this._kind===T)e=t;else{var i=this._collection.modelId(t.attributes);e=this._kind===A?i:[i,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}},x.extend=y;var H=function(e){this.cid=t.uniqueId("view"),this.preinitialize.apply(this,arguments),t.extend(this,t.pick(e,C)),this._ensureElement(),this.initialize.apply(this,arguments)},$=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];t.extend(H.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof Backbone.$?t:Backbone.$(t),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=t.result(this,"events")),!e)return this;this.undelegateEvents();for(var i in e){var n=e[i];if(t.isFunction(n)||(n=this[n]),n){var s=i.match($);this.delegate(s[1],s[2],t.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(t.result(this,"el"));else{var e=t.extend({},t.result(this,"attributes"));this.id&&(e.id=t.result(this,"id")),this.className&&(e.class=t.result(this,"className")),this.setElement(this._createElement(t.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(t){this.$el.attr(t)}}),H.extend=y;var M=function(){throw new Error('A "url" property or function must be specified')},R={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"},N=function(e,i,n){var s=R[e];t.defaults(n||(n={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var r={type:s,dataType:"json"};if(n.url||(r.url=t.result(i,"url")||M()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){r.type="POST",n.emulateJSON&&(r.data._method=s);var o=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",s),o)return o.apply(this,arguments)}}"GET"===r.type||n.emulateJSON||(r.processData=!1);var a=n.error;n.error=function(t,e,i){n.textStatus=e,n.errorThrown=i,a&&a.call(n.context,t,e,i)};var h=n.xhr=Backbone.ajax(t.extend(r,n));return i.trigger("request",i,h,n),h},j=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},U=/\((.*?)\)/g,B=/(\(\?)?:\w+/g,O=/\*\w+/g,z=/[\-{}\[\]+?.,\\\^$|#\s]/g;t.extend(j.prototype,o,{preinitialize:function(){},initialize:function(){},route:function(e,i,n){t.isRegExp(e)||(e=this._routeToRegExp(e)),t.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var s=this;return Backbone.history.route(e,function(t){var r=s._extractParameters(e,t);s.execute(n,r,i)!==!1&&(s.trigger.apply(s,["route:"+i].concat(r)),s.trigger("route",i,r),Backbone.history.trigger("route",s,i,r))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,e){return Backbone.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=t.result(this,"routes");for(var e,i=t.keys(this.routes);null!=(e=i.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(t){return t=t.replace(z,"\\$&").replace(U,"(?:$1)?").replace(B,function(t,e){return e?t:"([^/?]+)"}).replace(O,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,i){var n=e.exec(i).slice(1);return t.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}}),j.extend=y;var F=function(){this.handlers=[],this.checkUrl=t.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},q=/^[#\/]|\s+$/g,J=/^\/+|\/+$/g,L=/#.*$/;F.started=!1,t.extend(F.prototype,o,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(q,"")},start:function(e){if(F.started)throw new Error("Backbone.history has already been started");if(F.started=!0,this.options=t.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(J,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var i=this.root.slice(0,-1)||"/";return this.location.replace(i+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,s=n.insertBefore(this.iframe,n.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),F.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),t.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(t,e){if(!F.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;t=t.replace(L,"");var s=this.decodeFragment(t);if(this.fragment!==s){if(this.fragment=s,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),F.extend=y;
//  Copyright (c) 2010-2017 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//  Copyright (c) 2017 Aaron Nathaniel Gray
//  Distributed under the MIT License
//
var W={};W.VERSION=s,W._=t,W.$=e,W.Events=o,t.extend(W,o),W.Model=b,W.View=H;var V=function(t,e,i,n){switch(e){case 1:return function(){return t[i](this[n])};case 2:return function(e){return t[i](this[n],e)};case 3:return function(e,s){return t[i](this[n],G(e,this),s)};case 4:return function(e,s,r){return t[i](this[n],G(e,this),s,r)};default:return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this[n]),t[i].apply(t,e)}}},D=function(e,i,n,s){t.each(n,function(t,n){i[n]&&(e.prototype[n]=V(i,t,n,s))})},G=function(e,i){return t.isFunction(e)?e:t.isObject(e)&&!i._isModel(e)?Q(e):t.isString(e)?function(t){return t.get(e)}:e},Q=function(e){var i=t.matches(e);return function(t){return i(t.attributes)}},X={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},K={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};return t.each([[x,X,"models"],[b,K,"attributes"]],function(e){var i=e[0],n=e[1],s=e[2];i.mixin=function(e){var n=t.reduce(t.functions(e),function(t,e){return t[e]=0,t},{});D(i,e,n,s)},D(i,t,n,s)}),W.Model=b,W.View=H,W.Collection=x,W.Router=j,W.sync=N,W.ajax=i,W.History=F,W.history=new F,W});
//# sourceMappingURL=BackboneJS.min.js.map
